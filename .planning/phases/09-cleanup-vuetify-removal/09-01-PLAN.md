---
phase: "09"
plan: "09-01"
title: "Vuetify removal and final cleanup"
wave: 1
depends_on: ["08-03"]
files_modified:
  - "frontend/src/composables/useAppTheme.ts"
  - "frontend/src/main.ts"
  - "frontend/src/components/branding/KGDBLogo.vue"
  - "frontend/src/components/KidneyGeneticsLogo.vue"
  - "frontend/package.json"
files_deleted:
  - "frontend/src/plugins/vuetify.ts"
autonomous: true
estimated_minutes: 30
requirements:
  - "CLEAN-01: Zero files import from 'vuetify'"
  - "CLEAN-02: Zero Vuetify component tags in any .vue file"
  - "CLEAN-03: vuetify and @mdi/font removed from package.json"
  - "CLEAN-04: App builds and runs without Vuetify"

must_haves:
  truths:
    - "`grep -r \"from 'vuetify'\" frontend/src/` returns 0 results"
    - "`grep -rE 'v-container|v-row|v-col|v-card|v-btn|v-icon|v-chip|v-dialog|v-form|v-text-field|v-select|v-switch|v-data-table|v-list|v-alert|v-tabs|v-menu|v-snackbar|v-progress|v-expansion|v-tooltip|v-breadcrumbs|v-pagination|v-badge|v-avatar|v-footer|v-navigation-drawer|v-app-bar|v-divider|v-spacer' frontend/src/ --include='*.vue'` returns 0 results"
    - "`grep -rE 'd-flex|align-center|justify-space-between|text-h[3-6]|text-body-[12]|text-caption|text-medium-emphasis|elevation-|ga-[0-9]|bg-surface' frontend/src/ --include='*.vue'` returns 0 results"
    - "vuetify is NOT in frontend/package.json dependencies"
    - "@mdi/font is NOT in frontend/package.json dependencies"
    - "frontend/src/plugins/vuetify.ts does NOT exist"
    - "`npm run build` succeeds with zero Vuetify references"
    - "`npm run lint` passes with 0 errors"
    - "Light/dark mode toggle works on all pages"
    - "All logos render correctly in both modes"

---

# 09-01: Vuetify Removal and Final Cleanup

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Remove Vuetify and all related dependencies. Verify zero remaining references. Final build verification.

---

<task id="1">
### Task 1: Audit for remaining Vuetify usage

Run these audits BEFORE making any changes:

```bash
# 1. Files importing from 'vuetify'
grep -r "from 'vuetify'" frontend/src/ --include="*.ts" --include="*.vue"

# 2. Vuetify component tags
grep -rE "v-container|v-row|v-col|v-card|v-btn|v-icon|v-chip|v-dialog|v-form|v-text-field|v-select|v-switch|v-data-table|v-list|v-alert|v-tabs|v-menu|v-snackbar|v-progress|v-expansion|v-tooltip|v-breadcrumbs|v-pagination|v-badge|v-avatar|v-footer|v-app-bar|v-divider|v-spacer|v-navigation-drawer|v-toolbar|v-autocomplete|v-checkbox|v-radio|v-textarea|v-slider|v-stepper|v-timeline|v-window|v-chip-group|v-btn-group|v-btn-toggle|v-overlay|v-tab " \
  frontend/src/ --include="*.vue" | grep -v node_modules

# 3. Vuetify utility classes
grep -rE "d-flex|d-none|d-inline-flex|align-center|align-start|justify-space-between|justify-center|flex-grow-1|fill-height|ga-[0-9]|text-h[3-6]|text-body-[12]|text-subtitle|text-caption|text-medium-emphasis|font-weight-bold|font-weight-medium|elevation-|bg-surface|w-100|h-100" \
  frontend/src/ --include="*.vue" | grep -v node_modules
```

**If any results found:** Those files were missed in earlier phases. Fix them before proceeding.

**Expected at this point:** Only these files should reference Vuetify:
1. `src/plugins/vuetify.ts` — will be deleted
2. `src/composables/useAppTheme.ts` — will be modified
3. `src/main.ts` — will be modified
4. `src/components/branding/KGDBLogo.vue` — will be modified
5. `src/components/KidneyGeneticsLogo.vue` — will be modified
</task>

<task id="2" depends_on="1">
### Task 2: Update useAppTheme.ts

**Files:** Modify `frontend/src/composables/useAppTheme.ts`

**Remove:**
- `import { useTheme } from 'vuetify'`
- `const vuetifyTheme = useTheme()`
- Both `watch()` calls that sync Vuetify theme ↔ color mode

**Keep:**
- `import { useColorMode } from '@vueuse/core'`
- `useColorMode` setup with `kgdb-color-mode` storage key
- `isDark` computed
- `toggleTheme` function
- HTML class management for `dark` class (shadcn-vue needs this)

**Simplified composable:**
```typescript
import { computed } from 'vue'
import { useColorMode } from '@vueuse/core'

export function useAppTheme() {
  const mode = useColorMode({
    storageKey: 'kgdb-color-mode',
    initialValue: 'auto',
  })

  const isDark = computed(() => mode.value === 'dark')

  function toggleTheme() {
    mode.value = isDark.value ? 'light' : 'dark'
  }

  return { isDark, mode, toggleTheme }
}
```

**Commit:**
```bash
git add frontend/src/composables/useAppTheme.ts
git commit -m "feat(09-01): remove Vuetify theme sync from useAppTheme"
```
</task>

<task id="3" depends_on="2">
### Task 3: Update branding components

**Files:**
- `frontend/src/components/branding/KGDBLogo.vue`
- `frontend/src/components/KidneyGeneticsLogo.vue`

**For both files:**
1. Replace `import { useTheme } from 'vuetify'` → `import { useAppTheme } from '@/composables/useAppTheme'`
2. Replace `const theme = useTheme()` → `const { isDark } = useAppTheme()`
3. Replace `theme.global.current.value.dark` → `isDark.value`
4. Replace CSS `rgb(var(--v-theme-on-surface))` → `hsl(var(--foreground))` (shadcn-vue CSS variable)

**Commit:**
```bash
git add frontend/src/components/branding/KGDBLogo.vue frontend/src/components/KidneyGeneticsLogo.vue
git commit -m "feat(09-01): replace useTheme with useAppTheme in branding components"
```
</task>

<task id="4" depends_on="3">
### Task 4: Remove Vuetify from main.ts + delete plugin

**Files:**
- Modify `frontend/src/main.ts`
- Delete `frontend/src/plugins/vuetify.ts`

**In main.ts, remove:**
```typescript
import vuetify from '@/plugins/vuetify'
// ...
app.use(vuetify)
```

**Delete vuetify.ts:**
```bash
rm frontend/src/plugins/vuetify.ts
```

**Commit:**
```bash
git add frontend/src/main.ts
git rm frontend/src/plugins/vuetify.ts
git commit -m "feat(09-01): remove Vuetify plugin from app initialization"
```
</task>

<task id="5" depends_on="4">
### Task 5: Uninstall Vuetify packages

```bash
cd frontend && npm uninstall vuetify @mdi/font
```

**Verify package.json:**
```bash
grep -E "vuetify|@mdi/font" frontend/package.json
```
Expected: 0 matches.

**Commit:**
```bash
git add frontend/package.json frontend/package-lock.json
git commit -m "feat(09-01): uninstall vuetify and @mdi/font packages"
```
</task>

<task id="6" depends_on="5">
### Task 6: Final verification

**Step 1: Complete Vuetify audit**
```bash
grep -r "from 'vuetify'" frontend/src/
grep -r "vuetify" frontend/src/ --include="*.ts" --include="*.vue" | grep -v node_modules | grep -v ".d.ts"
grep -rE "v-container|v-row|v-col|v-card|v-btn|v-icon|v-chip" frontend/src/ --include="*.vue"
grep -rE "d-flex|align-center|justify-space-between|text-h[3-6]|text-medium-emphasis|elevation-|ga-[0-9]" frontend/src/ --include="*.vue"
```
ALL must return 0 results.

**Step 2: Build**
```bash
cd frontend && npm run build
```
Must succeed with zero errors.

**Step 3: Lint**
```bash
cd frontend && npm run lint
```
Must pass with 0 errors.

**Step 4: Bundle size comparison**
```bash
# Record the build output size (dist/ directory)
du -sh frontend/dist/
# Compare with pre-migration size if available
```

**Step 5: Full visual testing**
Test ALL pages in both light and dark mode:
- `/` — Home
- `/about` — About
- `/genes` — Gene browser
- `/genes/BRCA1` — Gene detail (or any gene)
- `/genes/BRCA1/structure` — Gene structure
- `/datasources` — Data sources
- `/dashboard` — Dashboard with charts
- `/network` — Network analysis
- `/profile` — User profile
- `/admin` — Admin dashboard
- `/admin/users` — User management
- `/admin/cache` — Cache management
- `/admin/pipeline` — Pipeline monitor
- `/admin/annotations` — Annotations
- `/admin/logs` — Log viewer
- `/admin/staging` — Gene staging
- `/admin/backups` — Backups
- `/admin/releases` — Releases
- `/admin/settings` — Settings
- `/admin/hybrid-sources` — Hybrid sources
- Toggle dark mode on each page — logos and charts adapt

**Step 6: Final commit**
```bash
git commit -m "feat(09-01): complete Vuetify removal - migration to shadcn-vue finished" --allow-empty
```
</task>
