---
phase: "07"
plan: "07-03"
title: "AdminUserManagement, AdminCacheManagement, AdminPipeline, LogViewer"
wave: 3
depends_on: ["07-01"]
files_modified:
  - "frontend/src/views/admin/AdminUserManagement.vue"
  - "frontend/src/views/admin/AdminCacheManagement.vue"
  - "frontend/src/views/admin/AdminPipeline.vue"
  - "frontend/src/components/admin/LogViewer.vue"
autonomous: true
estimated_minutes: 60
requirements:
  - "ADMIN-08: AdminUserManagement uses DataTable + Dialog for CRUD"
  - "ADMIN-09: AdminCacheManagement uses Card + DataTable"
  - "ADMIN-10: AdminPipeline uses Card + Progress + WebSocket"
  - "ADMIN-11: LogViewer uses Sheet + Accordion"

must_haves:
  truths:
    - "All 4 files have zero Vuetify component tags"
    - "`npm run build` succeeds"
    - "`npm run lint` has 0 errors"
    - "User CRUD operations work (create, edit, toggle status, delete)"
    - "Cache management displays namespaces and supports clear/warm"
    - "Pipeline monitor shows real-time progress"
    - "LogViewer sidebar displays and filters logs"

---

# 07-03: Admin Users, Cache, Pipeline, LogViewer

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Migrate 4 admin views/components covering user management, cache control, pipeline monitoring, and the log viewer sidebar.

---

<task id="1">
### Task 1: Migrate AdminUserManagement.vue

**Files:** Modify `frontend/src/views/admin/AdminUserManagement.vue`

**Key replacements:**
- `v-container` → Tailwind container
- `v-data-table` → DataTable (client-side)
- `v-dialog` (create/edit form) → Dialog
- `v-dialog` (delete confirmation) → AlertDialog
- `v-form` + `v-text-field` → Input + Label
- `v-select` (role) → Select
- `v-checkbox` → native checkbox or Checkbox from shadcn-vue
- `v-chip` (role badge) → Badge
- `v-btn` → Button

**User table columns:**
```typescript
const columns: ColumnDef<User>[] = [
  { accessorKey: 'username', header: 'Username' },
  { accessorKey: 'email', header: 'Email' },
  { accessorKey: 'role', header: 'Role', cell: ({ row }) => h(Badge, { variant: getRoleVariant(row.getValue('role')) }, () => row.getValue('role')) },
  { accessorKey: 'is_active', header: 'Status', cell: ({ row }) => h(Badge, { variant: row.getValue('is_active') ? 'default' : 'secondary' }, () => row.getValue('is_active') ? 'Active' : 'Inactive') },
  { id: 'actions', header: '', cell: ({ row }) => h(UserActionsCell, { user: row.original }) },
]
```

**Create/Edit dialog:**
```vue
<Dialog v-model:open="showCreateDialog">
  <DialogContent class="max-w-[500px]">
    <DialogHeader>
      <DialogTitle>{{ editingUser ? 'Edit User' : 'Create User' }}</DialogTitle>
    </DialogHeader>
    <div class="space-y-4">
      <div class="space-y-2">
        <Label for="username">Username</Label>
        <Input id="username" v-model="userFormData.username" />
      </div>
      <div class="space-y-2">
        <Label for="email">Email</Label>
        <Input id="email" v-model="userFormData.email" type="email" />
      </div>
      <div class="space-y-2">
        <Label for="role">Role</Label>
        <Select v-model="userFormData.role">
          <SelectTrigger><SelectValue /></SelectTrigger>
          <SelectContent>
            <SelectItem value="admin">Admin</SelectItem>
            <SelectItem value="curator">Curator</SelectItem>
            <SelectItem value="viewer">Viewer</SelectItem>
          </SelectContent>
        </Select>
      </div>
      <div v-if="!editingUser" class="space-y-2">
        <Label for="password">Password</Label>
        <Input id="password" v-model="userFormData.password" type="password" />
      </div>
    </div>
    <DialogFooter>
      <Button variant="outline" @click="showCreateDialog = false">Cancel</Button>
      <Button :disabled="saving" @click="saveUser">
        {{ saving ? 'Saving...' : 'Save' }}
      </Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

**Commit:**
```bash
git add frontend/src/views/admin/AdminUserManagement.vue
git commit -m "feat(07-03): migrate AdminUserManagement to DataTable + Dialog"
```
</task>

<task id="2">
### Task 2: Migrate AdminCacheManagement.vue

**Files:** Modify `frontend/src/views/admin/AdminCacheManagement.vue`

**Key replacements:**
- `v-container` → Tailwind container
- `v-card` → Card
- `v-data-table` → DataTable
- `v-chip` → Badge
- `v-dialog` → Dialog / AlertDialog
- `v-btn` → Button
- `v-list`/`v-list-item` → styled divs

**Cache namespace table** uses DataTable with columns: namespace, entry_count, size, oldest_entry, actions.

**Health status** display as a simple list with check/x icons.

**Commit:**
```bash
git add frontend/src/views/admin/AdminCacheManagement.vue
git commit -m "feat(07-03): migrate AdminCacheManagement to DataTable + Card"
```
</task>

<task id="3">
### Task 3: Migrate AdminPipeline.vue

**Files:** Modify `frontend/src/views/admin/AdminPipeline.vue`

**Key replacements:**
- `v-container` → Tailwind container
- `v-card` → Card
- `v-chip` (WebSocket status, source status) → Badge
- `v-progress-linear` → Progress
- `v-btn` → Button
- `v-alert` → Alert
- `v-list`/`v-list-item` → styled divs

**Keep all WebSocket connection logic unchanged.** Only replace the template.

**Source card pattern (similar to DataSourceProgress but more detailed):**
```vue
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  <Card v-for="source in sources" :key="source.name">
    <CardHeader class="pb-2">
      <div class="flex items-center justify-between">
        <CardTitle class="text-sm">{{ source.display_name }}</CardTitle>
        <Badge :variant="getStatusVariant(source.status)">{{ source.status }}</Badge>
      </div>
    </CardHeader>
    <CardContent>
      <Progress v-if="source.status === 'running'" :model-value="source.progress" class="h-2 mb-2" />
      <p v-if="source.current_operation" class="text-xs text-muted-foreground mb-2">{{ source.current_operation }}</p>
      <!-- Stats -->
      <div class="grid grid-cols-3 gap-2 text-xs text-center">
        <div><span class="font-bold text-green-500">{{ source.items_added }}</span><br>added</div>
        <div><span class="font-bold text-blue-500">{{ source.items_updated }}</span><br>updated</div>
        <div><span class="font-bold text-red-500">{{ source.items_failed }}</span><br>failed</div>
      </div>
      <!-- Action buttons -->
      <div class="flex gap-1 mt-3">
        <Button v-if="source.status === 'idle'" size="sm" variant="outline" @click="runSource(source.name)">
          <Play :size="12" class="mr-1" /> Run
        </Button>
        <Button v-if="source.status === 'running'" size="sm" variant="outline" @click="pauseSource(source.name)">
          <Pause :size="12" class="mr-1" /> Pause
        </Button>
      </div>
    </CardContent>
  </Card>
</div>
```

**Commit:**
```bash
git add frontend/src/views/admin/AdminPipeline.vue
git commit -m "feat(07-03): migrate AdminPipeline to Card + Progress + Badge"
```
</task>

<task id="4">
### Task 4: Migrate LogViewer.vue (sidebar component)

**Files:** Modify `frontend/src/components/admin/LogViewer.vue`

**Key replacements:**
- `v-navigation-drawer` → Sheet (side="right")
- `v-toolbar` → styled header div
- `v-text-field` → Input
- `v-select` → Select (multi-select for log levels)
- `v-chip` (log level) → Badge
- `v-expansion-panels` → Accordion
- `v-btn` → Button
- `v-divider` → Separator

**Sheet-based sidebar:**
```vue
<Sheet :open="isOpen" @update:open="$emit('update:open', $event)">
  <SheetContent side="right" class="w-[600px] sm:max-w-[600px]">
    <SheetHeader>
      <SheetTitle>System Logs</SheetTitle>
      <SheetDescription>Real-time application logs</SheetDescription>
    </SheetHeader>
    <!-- Filters -->
    <div class="flex gap-2 my-4">
      <Input v-model="searchQuery" placeholder="Search logs..." class="flex-1" />
      <!-- Level filter badges -->
    </div>
    <!-- Log entries -->
    <ScrollArea class="h-[calc(100vh-200px)]">
      <Accordion type="single" collapsible>
        <AccordionItem v-for="log in filteredLogs" :key="log.id" :value="log.id">
          <AccordionTrigger class="py-2 text-xs">
            <div class="flex items-center gap-2 w-full">
              <Badge :variant="getLevelVariant(log.level)" class="text-[10px]">{{ log.level }}</Badge>
              <span class="truncate flex-1">{{ log.message }}</span>
              <span class="text-muted-foreground shrink-0">{{ formatTime(log.timestamp) }}</span>
            </div>
          </AccordionTrigger>
          <AccordionContent>
            <pre class="text-xs bg-muted p-2 rounded overflow-x-auto">{{ formatLogDetails(log) }}</pre>
          </AccordionContent>
        </AccordionItem>
      </Accordion>
    </ScrollArea>
  </SheetContent>
</Sheet>
```

**Commit:**
```bash
git add frontend/src/components/admin/LogViewer.vue
git commit -m "feat(07-03): migrate LogViewer to Sheet + Accordion"
```
</task>

<task id="5" depends_on="1,2,3,4">
### Task 5: Verification

```bash
cd frontend && npm run build && npm run lint
```

**Vuetify audit:**
```bash
grep -rE "v-navigation-drawer|v-toolbar|v-data-table|v-dialog|v-form|v-text-field|v-select|v-checkbox|v-chip|v-card|v-btn|v-alert|v-list|v-progress-linear|v-expansion-panel|v-container|v-row|v-col|v-divider" \
  frontend/src/views/admin/AdminUserManagement.vue \
  frontend/src/views/admin/AdminCacheManagement.vue \
  frontend/src/views/admin/AdminPipeline.vue \
  frontend/src/components/admin/LogViewer.vue
```
Expected: 0 matches.
</task>
