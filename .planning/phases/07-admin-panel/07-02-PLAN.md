---
phase: "07"
plan: "07-02"
title: "Backup dialogs + AdminBackups + Settings dialogs + AdminSettings"
wave: 2
depends_on: ["07-01"]
files_modified:
  - "frontend/src/components/admin/backups/BackupCreateDialog.vue"
  - "frontend/src/components/admin/backups/BackupDeleteDialog.vue"
  - "frontend/src/components/admin/backups/BackupDetailsDialog.vue"
  - "frontend/src/components/admin/backups/BackupFilters.vue"
  - "frontend/src/components/admin/backups/BackupRestoreDialog.vue"
  - "frontend/src/components/admin/settings/SettingEditDialog.vue"
  - "frontend/src/components/admin/settings/SettingHistoryDialog.vue"
  - "frontend/src/views/admin/AdminBackups.vue"
  - "frontend/src/views/admin/AdminSettings.vue"
autonomous: true
estimated_minutes: 60
requirements:
  - "ADMIN-04: Backup dialogs use Dialog/AlertDialog"
  - "ADMIN-05: Settings dialogs use Dialog + Form inputs"
  - "ADMIN-06: AdminBackups uses DataTable + Dialog"
  - "ADMIN-07: AdminSettings uses DataTable + Dialog"

must_haves:
  truths:
    - "All 9 files have zero Vuetify component tags"
    - "`npm run build` succeeds"
    - "`npm run lint` has 0 errors"
    - "Backup CRUD operations work (create, restore, details, delete)"
    - "Settings edit dialog saves changes with reason tracking"
    - "Settings history displays timeline of changes"

---

# 07-02: Backup and Settings Components

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Migrate all backup dialog components (5 files), settings dialog components (2 files), and their parent views (2 files).

---

## Common Dialog Pattern

All dialogs follow this conversion pattern:

```vue
<!-- BEFORE: Vuetify -->
<v-dialog v-model="show" max-width="600">
  <v-card>
    <v-card-title>Title</v-card-title>
    <v-card-text>Content</v-card-text>
    <v-card-actions>
      <v-spacer />
      <v-btn @click="close">Cancel</v-btn>
      <v-btn @click="save">Save</v-btn>
    </v-card-actions>
  </v-card>
</v-dialog>

<!-- AFTER: shadcn-vue -->
<Dialog :open="modelValue" @update:open="$emit('update:modelValue', $event)">
  <DialogContent class="max-w-[600px]">
    <DialogHeader>
      <DialogTitle>Title</DialogTitle>
      <DialogDescription>Description</DialogDescription>
    </DialogHeader>
    <!-- Content -->
    <DialogFooter>
      <Button variant="outline" @click="$emit('update:modelValue', false)">Cancel</Button>
      <Button @click="save">Save</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

For destructive confirmations, use AlertDialog instead:
```vue
<AlertDialog :open="modelValue" @update:open="$emit('update:modelValue', $event)">
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>Are you sure?</AlertDialogTitle>
      <AlertDialogDescription>This action cannot be undone.</AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel>Cancel</AlertDialogCancel>
      <AlertDialogAction @click="confirm">Continue</AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

---

<task id="1">
### Task 1: Migrate backup dialog components (5 files)

**Files:**
- `BackupCreateDialog.vue` — Dialog + Input + Select + Switch + Alert
- `BackupDeleteDialog.vue` — AlertDialog (destructive confirmation)
- `BackupDetailsDialog.vue` — Dialog + styled list
- `BackupFilters.vue` — Card + Select + Input + Button (NOT a dialog)
- `BackupRestoreDialog.vue` — Dialog + Alert (warning) + Switch

**For each dialog file:**
1. Replace `v-dialog` → Dialog or AlertDialog
2. Replace `v-card`/`v-card-title`/`v-card-text`/`v-card-actions` → DialogContent/DialogHeader/DialogTitle/DialogFooter
3. Replace `v-text-field` → Input + Label
4. Replace `v-select` → Select
5. Replace `v-switch` → Switch
6. Replace `v-alert` → Alert
7. Replace `v-btn` → Button
8. Replace `v-spacer` → remove (DialogFooter handles alignment)
9. Replace `v-list`/`v-list-item` → styled divs

**BackupFilters special case (not a dialog):**
- Replace `v-card` → Card
- Replace `v-select` → Select
- Replace `v-text-field` → Input
- Replace `v-btn` → Button

**Commit:**
```bash
git add frontend/src/components/admin/backups/
git commit -m "feat(07-02): migrate backup dialogs + filters to Dialog + AlertDialog"
```
</task>

<task id="2">
### Task 2: Migrate settings dialog components (2 files)

**Files:**
- `SettingEditDialog.vue` — Dialog + Input (dynamic type) + Textarea + Alert
- `SettingHistoryDialog.vue` — Dialog + timeline display

**SettingEditDialog:**
- Replace `v-dialog` → Dialog
- Replace `v-text-field` → Input (with dynamic `type` based on `setting.value_type`)
- Replace `v-textarea` → native `<textarea>` with Tailwind classes or shadcn-vue equivalent
- Replace `v-alert` → Alert
- Keep `hasChanges` computed and dynamic input logic

**SettingHistoryDialog:**
- Replace `v-dialog` → Dialog with ScrollArea
- Replace `v-timeline` → custom timeline with Tailwind:
```vue
<div class="space-y-4">
  <div v-for="entry in history" :key="entry.id" class="relative pl-6 border-l-2 border-border">
    <div class="absolute -left-[5px] top-1 h-2 w-2 rounded-full bg-primary" />
    <div class="rounded-md border p-3">
      <div class="flex items-center justify-between mb-1">
        <span class="text-xs text-muted-foreground">{{ formatDate(entry.changed_at) }}</span>
        <Badge variant="secondary" class="text-[10px]">{{ entry.changed_by_id }}</Badge>
      </div>
      <div class="text-xs space-y-1">
        <div><span class="text-muted-foreground">Old:</span> {{ entry.old_value }}</div>
        <div><span class="text-muted-foreground">New:</span> {{ entry.new_value }}</div>
        <div v-if="entry.change_reason"><span class="text-muted-foreground">Reason:</span> {{ entry.change_reason }}</div>
      </div>
    </div>
  </div>
</div>
```
- Replace `v-progress-circular` → Tailwind spinner

**Commit:**
```bash
git add frontend/src/components/admin/settings/
git commit -m "feat(07-02): migrate settings dialogs to Dialog + timeline"
```
</task>

<task id="3" depends_on="1">
### Task 3: Migrate AdminBackups.vue

**Files:** Modify `frontend/src/views/admin/AdminBackups.vue`

**Key replacements:**
- `v-container` → Tailwind container
- `v-card` → Card
- `v-data-table` → DataTable (from 06-01 infrastructure)
- `v-chip` → Badge
- `v-pagination` → DataTablePagination
- `v-btn` → Button
- `v-tooltip` → Tooltip

**Use TanStack Table** with client-side pagination for backups list. Define columns for: filename, status, size, created_at, trigger, actions.

**Commit:**
```bash
git add frontend/src/views/admin/AdminBackups.vue
git commit -m "feat(07-02): migrate AdminBackups to DataTable + Dialog"
```
</task>

<task id="4" depends_on="2">
### Task 4: Migrate AdminSettings.vue

**Files:** Modify `frontend/src/views/admin/AdminSettings.vue`

**Key replacements:**
- `v-container` → Tailwind container
- `v-select` (category filter) → Select
- `v-data-table` → DataTable
- `v-chip` (restart badge) → Badge
- `v-btn` → Button
- `v-tooltip` → Tooltip

**Column definitions** for settings table: key, value (masked if sensitive), category, restart_required, actions (edit, history).

**Commit:**
```bash
git add frontend/src/views/admin/AdminSettings.vue
git commit -m "feat(07-02): migrate AdminSettings to DataTable + Select"
```
</task>

<task id="5" depends_on="3,4">
### Task 5: Verification

```bash
cd frontend && npm run build && npm run lint
```

**Vuetify audit on all 9 files:**
```bash
grep -rE "v-dialog|v-card|v-text-field|v-select|v-switch|v-alert|v-btn|v-spacer|v-list|v-timeline|v-progress-circular|v-data-table|v-pagination|v-chip|v-tooltip|v-textarea|v-container|v-row|v-col" \
  frontend/src/components/admin/backups/ \
  frontend/src/components/admin/settings/ \
  frontend/src/views/admin/AdminBackups.vue \
  frontend/src/views/admin/AdminSettings.vue \
  --include="*.vue"
```
Expected: 0 matches.

**Visual:** Backup create/restore/delete dialogs work. Settings edit dialog saves. History timeline displays.
</task>
