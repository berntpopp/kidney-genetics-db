---
phase: 01-foundation-setup
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - frontend/package.json
  - frontend/vite.config.ts
  - frontend/src/assets/main.css
  - frontend/src/main.js
  - frontend/src/lib/utils.ts
  - frontend/components.json
  - frontend/src/components/ui/button/Button.vue
  - frontend/src/components/ui/button/index.ts
  - frontend/src/plugins/vuetify.js
autonomous: true

must_haves:
  truths:
    - "Tailwind utility classes (e.g., bg-primary, text-foreground) render correctly when added to any Vue template"
    - "Existing Vuetify components continue rendering without visual regression"
    - "shadcn-vue CLI can add components into src/components/ui/"
    - "cn() utility function merges Tailwind classes correctly"
    - "CSS custom properties (--primary, --background, etc.) are available in both light and dark modes"
    - "Domain colors (--kidney-primary, --dna-primary) are available as Tailwind utilities"
  artifacts:
    - path: "frontend/src/assets/main.css"
      provides: "CSS coexistence layer with @layer ordering and theme variables"
      contains: "@layer theme, base, vuetify, components, utilities"
    - path: "frontend/components.json"
      provides: "shadcn-vue configuration"
      contains: "shadcn-vue"
    - path: "frontend/src/lib/utils.ts"
      provides: "cn() class merge utility"
      contains: "clsx"
    - path: "frontend/vite.config.ts"
      provides: "Vite config with tailwindcss plugin"
      contains: "tailwindcss"
    - path: "frontend/src/components/ui/button/Button.vue"
      provides: "shadcn-vue Button component proving CLI works"
      contains: "ButtonHTMLAttributes"
  key_links:
    - from: "frontend/vite.config.ts"
      to: "@tailwindcss/vite"
      via: "plugin import"
      pattern: "tailwindcss\\(\\)"
    - from: "frontend/src/main.js"
      to: "frontend/src/assets/main.css"
      via: "CSS import"
      pattern: "import.*main\\.css"
    - from: "frontend/src/assets/main.css"
      to: "vuetify/styles"
      via: "@import layer(vuetify)"
      pattern: "vuetify.*layer\\(vuetify\\)"
    - from: "frontend/src/lib/utils.ts"
      to: "clsx"
      via: "import"
      pattern: "import.*clsx"
---

<objective>
Install Tailwind CSS v4, shadcn-vue, and supporting libraries. Create the CSS coexistence layer that wraps Vuetify styles in `@layer(vuetify)` so Tailwind utilities win in specificity without breaking existing components. Initialize shadcn-vue CLI, install a test Button component, and set up the cn() utility.

Purpose: Establishes the CSS and component foundation. After this plan, any Vue template can use Tailwind classes alongside Vuetify components without conflicts, and new shadcn-vue components can be added via CLI.

Output: Working Tailwind + Vuetify CSS coexistence, shadcn-vue initialized with Button component, cn() utility available.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-setup/01-CONTEXT.md
@frontend/package.json
@frontend/vite.config.ts
@frontend/src/main.js
@frontend/src/plugins/vuetify.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Tailwind v4, shadcn-vue dependencies, and create CSS coexistence layer</name>
  <files>
    frontend/package.json
    frontend/vite.config.ts
    frontend/src/assets/main.css
    frontend/src/main.js
    frontend/src/plugins/vuetify.js
  </files>
  <action>
    1. Install Tailwind CSS v4 and its Vite plugin:
       ```bash
       cd frontend
       npm install tailwindcss@^4.2.0 @tailwindcss/vite@^4.2.0
       ```

    2. Install shadcn-vue runtime dependencies (do NOT run `npx shadcn-vue init` yet — we will manually set up to control the configuration precisely):
       ```bash
       cd frontend
       npm install clsx@^2.1.0 tailwind-merge@^3.0.0 class-variance-authority@^0.7.0
       npm install reka-ui@^2.0.0
       npm install lucide-vue-next@^0.475.0
       ```
       IMPORTANT: tailwind-merge MUST be v3.x (not v2.x) for Tailwind v4 compatibility. Verify with `npm ls tailwind-merge`.

    3. Install additional runtime libraries needed from Phase 1 onward (specified in STACK.md):
       ```bash
       cd frontend
       npm install @vueuse/core@^14.2.0
       ```
       Note: Do NOT install vee-validate, zod, @tanstack/vue-table, or vue-sonner yet — those are used from Phase 3+ and should be installed when needed.

    4. Update `frontend/vite.config.ts` to add the Tailwind CSS plugin:
       ```typescript
       import { defineConfig } from 'vite'
       import vue from '@vitejs/plugin-vue'
       import tailwindcss from '@tailwindcss/vite'
       import { fileURLToPath, URL } from 'node:url'
       import { readFileSync } from 'fs'

       const packageJson = JSON.parse(
         readFileSync(new URL('./package.json', import.meta.url), 'utf-8')
       )

       export default defineConfig({
         plugins: [
           vue(),
           tailwindcss(),
         ],
         resolve: {
           alias: {
             '@': fileURLToPath(new URL('./src', import.meta.url))
           }
         },
         define: {
           __APP_VERSION__: JSON.stringify(packageJson.version)
         },
         server: {
           port: 5173,
           proxy: {
             '/api': {
               target: 'http://localhost:8000',
               changeOrigin: true
             }
           }
         }
       })
       ```

    5. Create `frontend/src/assets/main.css` with the full CSS coexistence layer. This is the critical file that makes Vuetify and Tailwind work together:
       ```css
       @layer theme, base, vuetify, components, utilities;

       @import 'vuetify/styles' layer(vuetify);
       @import '@mdi/font/css/materialdesignicons.css' layer(vuetify);
       @import "tailwindcss";

       :root {
         --radius: 0.625rem;

         /* shadcn-vue semantic tokens (light) */
         --background: oklch(1 0 0);
         --foreground: oklch(0.145 0 0);
         --primary: oklch(0.205 0 0);
         --primary-foreground: oklch(0.985 0 0);
         --secondary: oklch(0.97 0 0);
         --secondary-foreground: oklch(0.205 0 0);
         --muted: oklch(0.97 0 0);
         --muted-foreground: oklch(0.556 0 0);
         --accent: oklch(0.97 0 0);
         --accent-foreground: oklch(0.205 0 0);
         --destructive: oklch(0.577 0.245 27.325);
         --border: oklch(0.922 0 0);
         --input: oklch(0.922 0 0);
         --ring: oklch(0.708 0 0);

         /* Domain-specific colors */
         --kidney-primary: oklch(0.69 0.1 194);
         --kidney-secondary: oklch(0.62 0.12 192);
         --dna-primary: oklch(0.69 0.18 220);
         --dna-secondary: oklch(0.59 0.17 294);

         /* Card and popover tokens */
         --card: oklch(1 0 0);
         --card-foreground: oklch(0.145 0 0);
         --popover: oklch(1 0 0);
         --popover-foreground: oklch(0.145 0 0);

         /* Sidebar tokens (for admin panel, Phase 7) */
         --sidebar: oklch(0.985 0 0);
         --sidebar-foreground: oklch(0.145 0 0);
         --sidebar-primary: oklch(0.205 0 0);
         --sidebar-primary-foreground: oklch(0.985 0 0);
         --sidebar-accent: oklch(0.97 0 0);
         --sidebar-accent-foreground: oklch(0.205 0 0);
         --sidebar-border: oklch(0.922 0 0);
         --sidebar-ring: oklch(0.708 0 0);

         /* Chart tokens */
         --chart-1: oklch(0.646 0.222 41.116);
         --chart-2: oklch(0.6 0.118 184.704);
         --chart-3: oklch(0.398 0.07 227.392);
         --chart-4: oklch(0.828 0.189 84.429);
         --chart-5: oklch(0.769 0.188 70.08);
       }

       .dark {
         --background: oklch(0.09 0 0);
         --foreground: oklch(0.97 0 0);
         --primary: oklch(0.97 0 0);
         --primary-foreground: oklch(0.205 0 0);
         --secondary: oklch(0.17 0 0);
         --secondary-foreground: oklch(0.97 0 0);
         --muted: oklch(0.17 0 0);
         --muted-foreground: oklch(0.64 0 0);
         --accent: oklch(0.17 0 0);
         --accent-foreground: oklch(0.97 0 0);
         --destructive: oklch(0.65 0.22 25);
         --border: oklch(0.17 0 0);
         --input: oklch(0.17 0 0);
         --ring: oklch(0.45 0 0);

         /* Domain-specific colors (dark) */
         --kidney-primary: oklch(0.78 0.1 194);
         --kidney-secondary: oklch(0.72 0.12 192);
         --dna-primary: oklch(0.72 0.13 220);
         --dna-secondary: oklch(0.71 0.14 294);

         /* Card and popover tokens (dark) */
         --card: oklch(0.09 0 0);
         --card-foreground: oklch(0.97 0 0);
         --popover: oklch(0.09 0 0);
         --popover-foreground: oklch(0.97 0 0);

         /* Sidebar tokens (dark) */
         --sidebar: oklch(0.12 0 0);
         --sidebar-foreground: oklch(0.97 0 0);
         --sidebar-primary: oklch(0.488 0.243 264.376);
         --sidebar-primary-foreground: oklch(0.985 0 0);
         --sidebar-accent: oklch(0.17 0 0);
         --sidebar-accent-foreground: oklch(0.97 0 0);
         --sidebar-border: oklch(0.17 0 0);
         --sidebar-ring: oklch(0.45 0 0);

         /* Chart tokens (dark) */
         --chart-1: oklch(0.488 0.243 264.376);
         --chart-2: oklch(0.696 0.17 162.48);
         --chart-3: oklch(0.769 0.188 70.08);
         --chart-4: oklch(0.627 0.265 303.9);
         --chart-5: oklch(0.645 0.246 16.439);
       }

       @theme inline {
         --color-background: var(--background);
         --color-foreground: var(--foreground);
         --color-primary: var(--primary);
         --color-primary-foreground: var(--primary-foreground);
         --color-secondary: var(--secondary);
         --color-secondary-foreground: var(--secondary-foreground);
         --color-muted: var(--muted);
         --color-muted-foreground: var(--muted-foreground);
         --color-accent: var(--accent);
         --color-accent-foreground: var(--accent-foreground);
         --color-destructive: var(--destructive);
         --color-border: var(--border);
         --color-input: var(--input);
         --color-ring: var(--ring);
         --color-kidney-primary: var(--kidney-primary);
         --color-kidney-secondary: var(--kidney-secondary);
         --color-dna-primary: var(--dna-primary);
         --color-dna-secondary: var(--dna-secondary);
         --color-card: var(--card);
         --color-card-foreground: var(--card-foreground);
         --color-popover: var(--popover);
         --color-popover-foreground: var(--popover-foreground);
         --color-sidebar: var(--sidebar);
         --color-sidebar-foreground: var(--sidebar-foreground);
         --color-sidebar-primary: var(--sidebar-primary);
         --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
         --color-sidebar-accent: var(--sidebar-accent);
         --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
         --color-sidebar-border: var(--sidebar-border);
         --color-sidebar-ring: var(--sidebar-ring);
         --color-chart-1: var(--chart-1);
         --color-chart-2: var(--chart-2);
         --color-chart-3: var(--chart-3);
         --color-chart-4: var(--chart-4);
         --color-chart-5: var(--chart-5);
         --radius-sm: calc(var(--radius) - 4px);
         --radius-md: calc(var(--radius) - 2px);
         --radius-lg: var(--radius);
         --radius-xl: calc(var(--radius) + 4px);
       }
       ```

    6. Update `frontend/src/main.js` to import the new main.css INSTEAD of the Vuetify styles that are currently loaded via the vuetify plugin. Add at the top of the file, before other imports:
       ```javascript
       import './assets/main.css'
       ```
       This import MUST come before `import vuetify from './plugins/vuetify'` to ensure correct layer ordering.

    7. Update `frontend/src/plugins/vuetify.js` — REMOVE the two style imports at the top since they are now handled by main.css with @layer wrapping:
       ```javascript
       // REMOVE these two lines:
       // import 'vuetify/styles'
       // import '@mdi/font/css/materialdesignicons.css'
       ```
       Keep everything else in vuetify.js unchanged. The styles are now imported in main.css with `layer(vuetify)` wrapping, which is critical for the CSS specificity ordering to work.

    8. Verify the build works with the new CSS setup:
       ```bash
       cd frontend && npm run build
       ```
  </action>
  <verify>
    - `cd frontend && npm run build` exits 0
    - `cd frontend && npm ls tailwind-merge` shows v3.x (NOT v2.x)
    - `cat frontend/src/assets/main.css | grep "@layer theme"` confirms layer declaration
    - `cat frontend/src/assets/main.css | grep "vuetify.*layer(vuetify)"` confirms Vuetify is wrapped
    - `cat frontend/vite.config.ts | grep "tailwindcss"` confirms plugin is added
    - `grep -c "vuetify/styles" frontend/src/plugins/vuetify.js` returns 0 (import removed)
    - `grep "main.css" frontend/src/main.js` confirms CSS import exists
  </verify>
  <done>
    Tailwind CSS v4 is installed and configured via @tailwindcss/vite plugin. The CSS coexistence layer wraps Vuetify styles in @layer(vuetify) so Tailwind utilities have higher specificity. All OKLCH theme variables are defined for both light and dark modes. Domain colors (kidney, DNA) are available as Tailwind utilities (e.g., bg-kidney-primary). Build succeeds.
  </done>
</task>

<task type="auto">
  <name>Task 2: Initialize shadcn-vue, create cn() utility, and install test Button component</name>
  <files>
    frontend/components.json
    frontend/src/lib/utils.ts
    frontend/src/components/ui/button/Button.vue
    frontend/src/components/ui/button/index.ts
  </files>
  <action>
    1. Create `frontend/src/lib/utils.ts` manually (do not rely on shadcn-vue init which may overwrite our carefully crafted main.css):
       ```typescript
       import { type ClassValue, clsx } from 'clsx'
       import { twMerge } from 'tailwind-merge'

       export function cn(...inputs: ClassValue[]) {
         return twMerge(clsx(inputs))
       }
       ```

    2. Create `frontend/components.json` manually with the exact configuration for this project:
       ```json
       {
         "$schema": "https://shadcn-vue.com/schema.json",
         "style": "new-york",
         "typescript": true,
         "tailwind": {
           "config": "",
           "css": "src/assets/main.css",
           "baseColor": "neutral",
           "cssVariables": true
         },
         "aliases": {
           "components": "@/components",
           "utils": "@/lib/utils",
           "ui": "@/components/ui",
           "lib": "@/lib",
           "composables": "@/composables"
         }
       }
       ```
       IMPORTANT: `"config": ""` is correct for Tailwind v4 (no tailwind.config.js needed). The `css` path points to our main.css.

    3. Add the shadcn-vue Button component using the CLI:
       ```bash
       cd frontend && npx shadcn-vue@latest add button --yes
       ```
       This should install into `src/components/ui/button/`. If the CLI prompts interactively, use `--yes` to auto-accept. If `--yes` is not supported, create the button component manually by checking shadcn-vue docs.

    4. Verify the Button component was installed:
       - `frontend/src/components/ui/button/Button.vue` should exist
       - `frontend/src/components/ui/button/index.ts` should exist
       - The Button.vue should import from `@/lib/utils` and use `cn()`

    5. If the CLI did NOT work (auth issues, network, version mismatch), create the Button component manually. Check the shadcn-vue source code or docs for the new-york style Button and create both files manually. The Button should use class-variance-authority and cn().

    6. Quick validation — add a temporary Tailwind test element to verify CSS coexistence works. This is NOT a permanent change; it's for spot-checking only. Open `frontend/src/App.vue` and add a hidden test element somewhere in the template (e.g., at the bottom, inside the existing layout):
       ```html
       <!-- Tailwind CSS test - remove after verification -->
       <div class="hidden bg-primary text-primary-foreground p-4 rounded-lg">
         Tailwind works
       </div>
       ```
       Then run `npm run dev`, open the browser, inspect the element to confirm Tailwind classes are applied. After confirming, REMOVE the test element.

    7. Run the final build to confirm everything works together:
       ```bash
       cd frontend && npm run build
       ```
  </action>
  <verify>
    - `ls frontend/components.json` exists
    - `cat frontend/components.json | grep "shadcn-vue"` confirms schema
    - `ls frontend/src/lib/utils.ts` exists
    - `cat frontend/src/lib/utils.ts | grep "cn"` confirms cn() function
    - `ls frontend/src/components/ui/button/Button.vue` exists
    - `cd frontend && npm run build` exits 0
    - `cd frontend && npx shadcn-vue@latest add alert-dialog --yes --dry-run` (if --dry-run is supported) — or just confirm the CLI recognizes components.json by running `npx shadcn-vue@latest add --help`
  </verify>
  <done>
    shadcn-vue is initialized with components.json pointing to our main.css and @/lib/utils. The cn() utility function works (clsx + tailwind-merge v3). A Button component is installed in src/components/ui/button/ proving the CLI pipeline works. The entire project builds successfully with Tailwind + Vuetify coexisting.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` exits 0 — Tailwind + Vuetify + shadcn-vue all compile correctly
2. `cd frontend && npm run dev` starts without errors — dev server works with new CSS setup
3. `cat frontend/src/assets/main.css | head -3` shows `@layer theme, base, vuetify, components, utilities`
4. `cat frontend/components.json` shows valid shadcn-vue configuration
5. `ls frontend/src/components/ui/button/` shows Button.vue and index.ts
6. `ls frontend/src/lib/utils.ts` exists with cn() export
7. `cd frontend && npm ls tailwind-merge` shows v3.x
8. `grep "vuetify/styles" frontend/src/plugins/vuetify.js` returns nothing (removed)
9. `grep "main.css" frontend/src/main.js` confirms import exists
</verification>

<success_criteria>
- FNDN-04: Tailwind CSS v4 installed with @tailwindcss/vite plugin (no PostCSS)
- FNDN-05: Tailwind v4 coexists with Vuetify without visual regressions (CSS @layer strategy, preflight disabled via layering)
- FNDN-06: shadcn-vue initialized with Reka UI primitives and components.json configured
- FNDN-07: cn() utility function available at src/lib/utils.ts (clsx + tailwind-merge v3)
- FNDN-08: Theme CSS variables mapped with --primary, --background, etc. in OKLCH with light/dark mode, plus domain colors (kidney, DNA)
- npm run build succeeds with all new dependencies
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-setup/01-02-SUMMARY.md`
</output>
