---
phase: 01-foundation-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/tsconfig.json
  - frontend/tsconfig.app.json
  - frontend/tsconfig.node.json
  - frontend/env.d.ts
  - frontend/src/types/gene.ts
  - frontend/src/types/auth.ts
  - frontend/src/types/api.ts
  - frontend/src/types/pipeline.ts
  - frontend/src/types/index.ts
  - frontend/vite.config.ts
  - frontend/package.json
autonomous: true

must_haves:
  truths:
    - "TypeScript compiler accepts existing .js and .vue files without errors (allowJs: true)"
    - "Path alias @/ resolves correctly in both IDE and build"
    - "npm run build succeeds with TypeScript-enabled vite config"
    - "npm run dev starts without errors"
    - "Domain type interfaces exist for gene, auth, API response, and pipeline entities"
  artifacts:
    - path: "frontend/tsconfig.json"
      provides: "Root TypeScript config with project references"
      contains: "references"
    - path: "frontend/tsconfig.app.json"
      provides: "App-level TypeScript config with strict mode"
      contains: "strict"
    - path: "frontend/tsconfig.node.json"
      provides: "Node-level TypeScript config for vite/vitest configs"
      contains: "composite"
    - path: "frontend/env.d.ts"
      provides: "Global type declarations for Vite env vars and Vue modules"
      contains: "ImportMetaEnv"
    - path: "frontend/vite.config.ts"
      provides: "Vite config renamed to TypeScript"
      contains: "defineConfig"
    - path: "frontend/src/types/gene.ts"
      provides: "Gene domain interfaces"
      contains: "interface Gene"
    - path: "frontend/src/types/auth.ts"
      provides: "Auth domain interfaces"
      contains: "interface User"
    - path: "frontend/src/types/api.ts"
      provides: "JSON:API response interfaces"
      contains: "interface JsonApiResponse"
    - path: "frontend/src/types/pipeline.ts"
      provides: "Pipeline status interfaces"
      contains: "interface PipelineStatus"
  key_links:
    - from: "frontend/tsconfig.json"
      to: "frontend/tsconfig.app.json"
      via: "project references"
      pattern: "tsconfig\\.app\\.json"
    - from: "frontend/tsconfig.app.json"
      to: "@vue/tsconfig/tsconfig.dom.json"
      via: "extends"
      pattern: "@vue/tsconfig"
    - from: "frontend/vite.config.ts"
      to: "frontend/tsconfig.json"
      via: "TypeScript resolution"
      pattern: "defineConfig"
---

<objective>
Install TypeScript tooling, create tsconfig project references, rename vite.config to TypeScript, and create domain type interface stubs for all major entities in the application.

Purpose: Establishes the TypeScript foundation that every subsequent phase depends on. With `allowJs: true` and `checkJs: false`, existing JS files continue working unchanged while new TS files get full type checking.

Output: Working TypeScript configuration, renamed vite.config.ts, domain type interfaces in `src/types/`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-setup/01-CONTEXT.md
@frontend/package.json
@frontend/vite.config.js
@frontend/src/main.js
@frontend/eslint.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install TypeScript packages and create tsconfig project references</name>
  <files>
    frontend/package.json
    frontend/tsconfig.json
    frontend/tsconfig.app.json
    frontend/tsconfig.node.json
    frontend/env.d.ts
  </files>
  <action>
    1. Install TypeScript dependencies:
       ```bash
       cd frontend
       npm install -D typescript@^5.7.0 vue-tsc@^2.2.0 @vue/tsconfig@^0.8.0 @types/node@^22.0.0
       ```

    2. Create `frontend/tsconfig.json` (root with project references):
       ```json
       {
         "files": [],
         "references": [
           { "path": "./tsconfig.app.json" },
           { "path": "./tsconfig.node.json" }
         ],
         "compilerOptions": {
           "baseUrl": ".",
           "paths": {
             "@/*": ["./src/*"]
           }
         }
       }
       ```

    3. Create `frontend/tsconfig.app.json`:
       ```json
       {
         "extends": "@vue/tsconfig/tsconfig.dom.json",
         "include": ["env.d.ts", "src/**/*", "src/**/*.vue"],
         "exclude": ["src/**/__tests__/*"],
         "compilerOptions": {
           "strict": true,
           "allowJs": true,
           "checkJs": false,
           "composite": true,
           "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
           "baseUrl": ".",
           "paths": {
             "@/*": ["./src/*"]
           },
           "verbatimModuleSyntax": true
         }
       }
       ```
       IMPORTANT: `allowJs: true` + `checkJs: false` means existing .js files are included but NOT type-checked. This avoids hundreds of errors from the existing JS codebase while enabling strict checking for new .ts files.

    4. Create `frontend/tsconfig.node.json`:
       ```json
       {
         "extends": "@tsconfig/node22/tsconfig.json",
         "include": ["vite.config.*", "vitest.config.*"],
         "compilerOptions": {
           "composite": true,
           "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
           "noEmit": true
         }
       }
       ```
       Note: `@tsconfig/node22` should be installed if not already present via `@vue/tsconfig`. Check after npm install. If missing: `npm install -D @tsconfig/node22`.

    5. Create `frontend/env.d.ts`:
       ```typescript
       /// <reference types="vite/client" />

       declare module '*.vue' {
         import type { DefineComponent } from 'vue'
         const component: DefineComponent<Record<string, unknown>, Record<string, unknown>, unknown>
         export default component
       }

       interface ImportMetaEnv {
         readonly VITE_API_BASE_URL?: string
         readonly MODE: string
         readonly DEV: boolean
         readonly PROD: boolean
       }

       interface ImportMeta {
         readonly env: ImportMetaEnv
       }

       declare const __APP_VERSION__: string
       ```

    6. Update `frontend/eslint.config.js` to include `.ts` and `.tsx` in file patterns:
       - Change `files: ['**/*.{js,mjs,cjs,vue}']` to `files: ['**/*.{js,mjs,cjs,ts,vue}']`
       - Add `'**/*.config.ts'` to ignores alongside `'*.config.js'`
  </action>
  <verify>
    Run from `frontend/`:
    - `npx vue-tsc --version` outputs version (confirms installation)
    - `npx vue-tsc --noEmit` runs without config errors (may report errors in existing JS — that is acceptable since checkJs is false; the command should NOT fail on config resolution)
    - `cat tsconfig.json | grep references` confirms project references exist
  </verify>
  <done>
    TypeScript packages installed, three tsconfig files created with project references, env.d.ts declares Vite globals and Vue module types, strict mode is ON, allowJs is true, checkJs is false. ESLint recognizes .ts files.
  </done>
</task>

<task type="auto">
  <name>Task 2: Rename vite.config to TypeScript and create domain type interfaces</name>
  <files>
    frontend/vite.config.ts
    frontend/src/types/gene.ts
    frontend/src/types/auth.ts
    frontend/src/types/api.ts
    frontend/src/types/pipeline.ts
    frontend/src/types/index.ts
  </files>
  <action>
    1. Rename `frontend/vite.config.js` to `frontend/vite.config.ts`. The content stays identical — Vite natively supports TS config files and the existing code is already valid TypeScript. Use `git mv` to preserve history:
       ```bash
       cd frontend && git mv vite.config.js vite.config.ts
       ```

    2. Create `frontend/src/types/` directory.

    3. Create `frontend/src/types/gene.ts` — Extract interfaces from existing API usage patterns in `src/api/genes.js`, `src/views/GeneDetail.vue`, etc. Include at minimum:
       ```typescript
       export interface Gene {
         id: number
         hgnc_id: string
         gene_symbol: string
         gene_name: string | null
         entrez_id: number | null
         ensembl_id: string | null
         omim_id: string | null
         gene_score: number | null
         evidence_count: number | null
         tier: string | null
         created_at: string
         updated_at: string
       }

       export interface GeneDetail extends Gene {
         annotations: Record<string, unknown>
         evidence_sources: EvidenceSource[]
       }

       export interface EvidenceSource {
         source_name: string
         source_data: Record<string, unknown>
         last_updated: string | null
       }

       export interface GeneListParams {
         page?: number
         perPage?: number
         search?: string
         minScore?: number | null
         maxScore?: number | null
         minCount?: number | null
         maxCount?: number | null
         source?: string | null
         tiers?: string[] | null
         sortBy?: string | null
         sortDesc?: boolean
         hideZeroScores?: boolean
       }
       ```

    4. Create `frontend/src/types/auth.ts`:
       ```typescript
       export interface User {
         id: number
         email: string
         username: string
         role: UserRole
         is_active: boolean
         created_at: string
         updated_at: string
       }

       export type UserRole = 'admin' | 'curator' | 'public'

       export interface LoginRequest {
         username: string
         password: string
       }

       export interface LoginResponse {
         access_token: string
         token_type: string
         user: User
       }

       export interface AuthState {
         user: User | null
         token: string | null
         isAuthenticated: boolean
       }
       ```

    5. Create `frontend/src/types/api.ts` — JSON:API response wrappers:
       ```typescript
       export interface JsonApiResponse<T> {
         data: T
         meta?: JsonApiMeta
         links?: JsonApiLinks
       }

       export interface JsonApiListResponse<T> {
         data: T[]
         meta?: JsonApiMeta
         links?: JsonApiLinks
       }

       export interface JsonApiMeta {
         total?: number
         page?: number
         per_page?: number
         total_pages?: number
         [key: string]: unknown
       }

       export interface JsonApiLinks {
         self?: string
         first?: string
         last?: string
         prev?: string | null
         next?: string | null
       }

       export interface JsonApiError {
         status: number
         title: string
         detail?: string
         source?: { pointer?: string; parameter?: string }
       }

       export interface ApiErrorResponse {
         errors: JsonApiError[]
       }
       ```

    6. Create `frontend/src/types/pipeline.ts`:
       ```typescript
       export interface PipelineStatus {
         is_running: boolean
         current_source: string | null
         progress: number
         total_genes: number
         processed_genes: number
         failed_genes: number
         start_time: string | null
         estimated_completion: string | null
       }

       export interface PipelineSource {
         name: string
         display_name: string
         enabled: boolean
         last_run: string | null
         status: PipelineSourceStatus
       }

       export type PipelineSourceStatus = 'idle' | 'running' | 'completed' | 'failed' | 'pending'

       export interface WebSocketMessage {
         type: string
         data: Record<string, unknown>
       }
       ```

    7. Create `frontend/src/types/index.ts` — barrel export:
       ```typescript
       export type * from './gene'
       export type * from './auth'
       export type * from './api'
       export type * from './pipeline'
       ```

    8. Verify the build still works:
       ```bash
       cd frontend && npm run build
       ```
       The build must succeed. Since we only added files and renamed vite.config.js -> .ts (which Vite handles natively), there should be no regressions.

    9. Verify dev server starts:
       ```bash
       cd frontend && npm run dev
       ```
       Start the dev server briefly and confirm it starts without errors, then stop it.
  </action>
  <verify>
    - `ls frontend/vite.config.ts` exists (and `vite.config.js` does NOT exist)
    - `ls frontend/src/types/` shows gene.ts, auth.ts, api.ts, pipeline.ts, index.ts
    - `cd frontend && npm run build` succeeds with exit code 0
    - `cd frontend && npx vue-tsc --noEmit` does not error on config resolution
  </verify>
  <done>
    vite.config.ts is the active config (JS version removed via git mv), five type definition files exist in src/types/ covering all major domain entities (gene, auth, API responses, pipeline), and the project builds and runs successfully.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` exits 0 — TypeScript config does not break the Vite build
2. `cd frontend && npm run dev` starts the dev server without errors
3. `cd frontend && npx vue-tsc --noEmit` runs without config resolution errors
4. `ls frontend/tsconfig.json frontend/tsconfig.app.json frontend/tsconfig.node.json frontend/env.d.ts` — all four config files exist
5. `ls frontend/src/types/gene.ts frontend/src/types/auth.ts frontend/src/types/api.ts frontend/src/types/pipeline.ts frontend/src/types/index.ts` — all five type files exist
6. `ls frontend/vite.config.ts` exists and `ls frontend/vite.config.js` does NOT exist
</verification>

<success_criteria>
- FNDN-01: TypeScript strict mode is enabled in tsconfig.app.json
- FNDN-02: tsconfig.json has project references, strict: true, allowJs: true, @/ path alias
- FNDN-03: Type definitions exist for Gene, User, JsonApiResponse, PipelineStatus and related interfaces
- npm run build and npm run dev work without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-setup/01-01-SUMMARY.md`
</output>
